<!DOCTYPE html>
<html>
  <head>
    <style>
      body { 
        margin: 0;
        background-color: #333;
      }
      .flipbook {
        width: 100vw;
        height: 100vh;
      }
      /* Icône de zoom personnalisée */
      .flipbook .viewport {
        cursor: url("https://www.sainte-rita.net/components/com_html5flippingbook/assets/images/zoom-ico.png"), zoom-in !important;
      }
      .flipbook .viewport.zoom {
        cursor: url("https://www.sainte-rita.net/components/com_html5flippingbook/assets/images/zoom-ico.png"), zoom-out !important;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <flipbook 
        ref="flipbook"
        class="flipbook" 
        :pages="pages" 
        :start-page="pageNum"
        :click-to-zoom="true"
        @flip-left-end="onFlipLeftEnd"
        @flip-right-end="onFlipRightEnd"
      />
    </div>
    <script src="https://unpkg.com/vue@3"></script>
    <script src="https://unpkg.com/flipbook-vue@latest/dist/flipbook.min.js"></script>
    <script>
      const { createApp } = Vue
      const app = createApp({
        data() {
          return {
            pages: [null, 'images/1.jpg', 'images/2.jpg', 'images/3.jpg', 'images/6.jpg'],
            pageNum: null
          }
        },
        methods: {
          onFlipLeftEnd(page) {
            console.log('flip-left-end', page)
            window.location.hash = '#page/' + page
          },
          onFlipRightEnd(page) {
            console.log('flip-right-end', page)
            window.location.hash = '#page/' + page
          },
          setPageFromHash() {
            const hash = window.location.hash
            const match = hash.match(/#page\/(\d+)/)
            if (match) {
              const n = parseInt(match[1], 10)
              if (isFinite(n)) this.pageNum = n
            }
          }
        },
        mounted() {
          window.addEventListener('hashchange', this.setPageFromHash)
          this.setPageFromHash()
          
          // Navigation au clavier
          window.addEventListener('keydown', (e) => {
            const flipbook = this.$refs.flipbook
            if (!flipbook) return
            
            // Flèche gauche (37) ou Q
            if (e.keyCode === 37 || e.key === 'ArrowLeft' || e.key === 'q' || e.key === 'Q') {
              if (flipbook.canFlipLeft) {
                flipbook.flipLeft()
                e.preventDefault()
              }
            }
            // Flèche droite (39) ou D  
            else if (e.keyCode === 39 || e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
              if (flipbook.canFlipRight) {
                flipbook.flipRight()
                e.preventDefault()
              }
            }
          })
        }
      })
      app.component('Flipbook', Flipbook)
      app.mount('#app')
    </script>
  </body>
</html>
